<template>
  <ion-page>
    <ion-header :translucent="true">
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-menu-button color="primary"></ion-menu-button>
        </ion-buttons>
        <ion-title>{{ getPageTitle() }}</ion-title>
        <ion-buttons slot="end">
          <ion-button @click="presentActionSheet">
            <ion-icon :icon="ellipsisVertical"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <ion-content :fullscreen="true">
      <ion-header collapse="condense">
        <ion-toolbar>
          <ion-title size="large">{{ getPageTitle() }}</ion-title>
        </ion-toolbar>
      </ion-header>

      <div id="container">
        <!-- Home Page -->
        <div v-if="route.params.id === 'Home'">
          <!-- SAGE Cover Illustration -->
          <div class="sage-cover-illustration-wrapper">
            <img src="/SAGE cover illustration disability.jpg" alt="Illustration of a diverse group of girls and community members, including a girl in a wheelchair, in a rural Zimbabwean setting" class="sage-cover-illustration" />
          </div>

          <ion-card>
            <ion-card-header>
              <ion-card-title>Government Introduction</ion-card-title>
              <ion-card-subtitle>Official foreword</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <p>
                This is a placeholder introductory message from the Ministry, outlining the importance of inclusive
                education and our shared commitment to supporting every learner. Further details and the final
                approved text will be added here.
              </p>
            </ion-card-content>
          </ion-card>

          <ion-card>
            <ion-card-header>
              <ion-card-title>Programme Partners</ion-card-title>
              <ion-card-subtitle>Sponsors and supporting organisations</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="partners-strip" role="group" aria-label="Programme sponsors and partners">
                <img src="/CBM_logo.png" alt="CBM" />
                <img src="/GEC_UKaid_lockup_RGB.jpg" alt="Girls' Education Challenge / UK Aid" />
                <img src="/PLAN_logo.png" alt="Plan International" />
                <img src="/sage-logo.png" alt="SAGE" />
              </div>
              <p>
                SAGE (Supporting Adolescent Girls' Education) is a UK Aid-funded programme through the UK's Foreign,
                Commonwealth and Development Office's Girls' Education Challenge initiative, led by Plan International
                and involving a consortium of six partners and the Ministry of Primary and Secondary Education, Zimbabwe
                (MoPSE).
              </p>
            </ion-card-content>
          </ion-card>

          <!-- Demo Video Player with Transcript -->
          <ion-card>
            <ion-card-header>
              <ion-card-title>Demo Video: Inclusive Education</ion-card-title>
              <ion-card-subtitle>Sample video with transcript</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <video controls style="width: 100%; border-radius: 8px;">
                <source src="/demo-video.mp4" type="video/mp4" />
                Your browser does not support the video tag.
              </video>
              <ion-accordion-group>
                <ion-accordion value="video-transcript">
                  <ion-item slot="header">
                    <ion-icon :icon="documentOutline" slot="start"></ion-icon>
                    <ion-label>Transcript</ion-label>
                  </ion-item>
                  <div class="ion-padding" slot="content">
                    <p><strong>Speaker 1:</strong> Welcome to this demonstration of inclusive education in action. In this video, you will see how teachers can adapt their classrooms to support all learners, including those with disabilities.</p>
                    <p><strong>Speaker 2:</strong> Notice how the teacher uses both visual and verbal instructions, and how students are encouraged to participate in different ways.</p>
                    <p><strong>Speaker 1:</strong> Remember, inclusion benefits everyone. Thank you for watching!</p>
                  </div>
                </ion-accordion>
              </ion-accordion-group>
            </ion-card-content>
          </ion-card>

          <!-- Demo Audio Player with Transcript -->
          <ion-card>
            <ion-card-header>
              <ion-card-title>Demo Audio: Welcome Message</ion-card-title>
              <ion-card-subtitle>Sample audio with transcript</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <audio controls style="width: 100%;">
                <source src="/demo-audio.mp3" type="audio/mp3" />
                Your browser does not support the audio element.
              </audio>
              <ion-accordion-group>
                <ion-accordion value="audio-transcript">
                  <ion-item slot="header">
                    <ion-icon :icon="documentOutline" slot="start"></ion-icon>
                    <ion-label>Transcript</ion-label>
                  </ion-item>
                  <div class="ion-padding" slot="content">
                    <p><strong>Narrator:</strong> Welcome to the SAGE Disability Toolkit. This audio guide will help you get started and make the most of the resources available. Remember, every learner is unique, and your support makes a difference!</p>
                  </div>
                </ion-accordion>
              </ion-accordion-group>
            </ion-card-content>
          </ion-card>
          <!-- Hero Section with Video -->
          <ion-card>
            <ion-card-header>
              <ion-card-title>Welcome to SAGE</ion-card-title>
              <ion-card-subtitle>Supporting Adolescent Girls' Education</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <p>SAGE is your mobile learning companion for understanding and supporting students with disabilities. 
              Get practical guidance, case studies, and resources to help create inclusive learning environments.</p>
              
              <!-- Video Component -->
              <ion-item>
                <ion-label>Introduction Video</ion-label>
                <ion-button fill="clear" @click="playVideo">
                  <ion-icon :icon="playCircle" slot="start"></ion-icon>
                  Play Video
                </ion-button>
              </ion-item>
            </ion-card-content>
          </ion-card>

          <!-- Progress Summary Card -->
          <ion-card v-if="overallProgress.percentage > 0" class="progress-summary-card">
            <ion-card-header>
              <ion-card-title>
                <ion-icon :icon="trophy" slot="start" :color="achievementLevel.color"></ion-icon>
                Your Learning Progress
              </ion-card-title>
              <ion-card-subtitle>Track your SAGE journey</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <div class="progress-summary-content">
                <div class="progress-circle-small" :style="{ '--progress': overallProgress.percentage }">
                  <div class="progress-circle-inner-small">
                    <div class="progress-percentage-small">{{ overallProgress.percentage }}%</div>
                  </div>
                </div>
                <div class="progress-details">
                  <ion-chip :color="achievementLevel.color" class="achievement-chip-small">
                    <ion-icon :icon="achievementLevel.icon"></ion-icon>
                    <ion-label>{{ achievementLevel.level }}</ion-label>
                  </ion-chip>
                  <p class="progress-stats-small">
                    {{ overallProgress.completedItems }} of {{ overallProgress.totalItems }} activities completed
                  </p>
                  <ion-button 
                    fill="clear" 
                    size="small" 
                    router-link="/progress" 
                    router-direction="forward"
                    class="view-progress-btn"
                  >
                    View Full Progress
                    <ion-icon :icon="arrowForward" slot="end"></ion-icon>
                  </ion-button>
                </div>
              </div>
            </ion-card-content>
          </ion-card>
              
              <ion-button expand="block" fill="outline" class="ion-margin-top" @click="startScreening">
                <ion-icon :icon="accessibilityOutline" slot="start"></ion-icon>
                Start Screening Tool
              </ion-button>

          <!-- Quick Stats with Progress -->
          <ion-card>
            <ion-card-header>
              <ion-card-title>Your Progress</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ion-progress-bar :value="0.3" color="primary"></ion-progress-bar>
              <ion-note>30% of content completed</ion-note>
              
              <ion-list>
                <ion-item>
                  <ion-icon :icon="checkmarkCircle" slot="start" color="success"></ion-icon>
                  <ion-label>Completed: General Information</ion-label>
                </ion-item>
                <ion-item>
                  <ion-icon :icon="time" slot="start" color="warning"></ion-icon>
                  <ion-label>In Progress: Screening Tool</ion-label>
                </ion-item>
                <ion-item>
                  <ion-icon :icon="ellipse" slot="start" color="medium"></ion-icon>
                  <ion-label>Not Started: Resources</ion-label>
                </ion-item>
              </ion-list>
            </ion-card-content>
          </ion-card>

          <!-- Feature Grid -->

          <!-- Media Players Section -->
          <ion-card>
            <ion-card-header>
              <ion-card-title>Media Resources</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <MediaPlayer 
                type="audio"
                title="Demo Audio: Welcome Message"
                subtitle="Audio guide for educators"
                src="/demo-audio.mp3"
                :duration="180">
              </MediaPlayer>
              <ion-accordion-group>
                <ion-accordion value="media-audio-transcript">
                  <ion-item slot="header">
                    <ion-icon :icon="documentOutline" slot="start"></ion-icon>
                    <ion-label>Transcript</ion-label>
                  </ion-item>
                  <div class="ion-padding" slot="content">
                    <p><strong>Narrator:</strong> Welcome to the SAGE Disability Toolkit. This audio guide will help you get started and make the most of the resources available. Remember, every learner is unique, and your support makes a difference!</p>
                  </div>
                </ion-accordion>
              </ion-accordion-group>
              
              <MediaPlayer 
                type="video"
                title="Demo Video: Inclusive Education"
                subtitle="Video tutorial on Universal Design for Learning"
                src="/demo-video.mp4"
                :duration="300">
              </MediaPlayer>
              <ion-accordion-group>
                <ion-accordion value="media-video-transcript">
                  <ion-item slot="header">
                    <ion-icon :icon="documentOutline" slot="start"></ion-icon>
                    <ion-label>Transcript</ion-label>
                  </ion-item>
                  <div class="ion-padding" slot="content">
                    <p><strong>Speaker 1:</strong> Welcome to this demonstration of inclusive education in action. In this video, you will see how teachers can adapt their classrooms to support all learners, including those with disabilities.</p>
                    <p><strong>Speaker 2:</strong> Notice how the teacher uses both visual and verbal instructions, and how students are encouraged to participate in different ways.</p>
                    <p><strong>Speaker 1:</strong> Remember, inclusion benefits everyone. Thank you for watching!</p>
                  </div>
                </ion-accordion>
              </ion-accordion-group>
            </ion-card-content>
          </ion-card>

          <!-- Quick Reference Guide -->
          <ion-card>
            <ion-card-header>
              <ion-card-title>Quick Reference Guide</ion-card-title>
              <ion-card-subtitle>Essential Information at Your Fingertips</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <h3>Key Principles of Inclusive Education</h3>
              <p>Inclusive education is based on the fundamental principle that all students have the right to participate in and benefit from education. This approach recognizes and values diversity, ensuring that every student feels welcomed, supported, and challenged to reach their full potential.</p>
              
              <h3>Universal Design for Learning (UDL)</h3>
              <p>UDL is a framework that guides the design of learning experiences to proactively meet the needs of all learners. It provides multiple means of engagement, representation, and action & expression, ensuring that learning is accessible to everyone.</p>
              
              <h3>Reasonable Adjustments</h3>
              <p>Reasonable adjustments are changes made to remove or reduce barriers that disabled students face in education. These adjustments are legally required and should be made in consultation with the student and their family.</p>
              
              <ion-list>
                <ion-item>
                  <ion-icon :icon="checkmark" slot="start" color="success"></ion-icon>
                  <ion-label>
                    <h4>Individualized Approach</h4>
                    <p>Every student is unique and requires personalized support strategies</p>
                  </ion-label>
                </ion-item>
                <ion-item>
                  <ion-icon :icon="checkmark" slot="start" color="success"></ion-icon>
                  <ion-label>
                    <h4>Collaborative Planning</h4>
                    <p>Involve students, parents, and professionals in decision-making</p>
                  </ion-label>
                </ion-item>
                <ion-item>
                  <ion-icon :icon="checkmark" slot="start" color="success"></ion-icon>
                  <ion-label>
                    <h4>Continuous Assessment</h4>
                    <p>Regularly evaluate and adjust support strategies based on progress</p>
                  </ion-label>
                </ion-item>
              </ion-list>
            </ion-card-content>
          </ion-card>

          <!-- Getting Started Tips -->
          <ion-card>
            <ion-card-header>
              <ion-card-title>Getting Started Tips</ion-card-title>
              <ion-card-subtitle>Making the Most of SAGE</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <h3>Step-by-Step Guide</h3>
              <ion-list>
                <ion-item>
                  <ion-label>
                    <h4>1. Complete the Screening Tool</h4>
                    <p>Start by taking the comprehensive assessment to identify your knowledge gaps and get personalized recommendations</p>
                  </ion-label>
                </ion-item>
                <ion-item>
                  <ion-label>
                    <h4>2. Explore General Information</h4>
                    <p>Read through the foundational content to understand key concepts and principles</p>
                  </ion-label>
                </ion-item>
                <ion-item>
                  <ion-label>
                    <h4>3. Focus on Specific Areas</h4>
                    <p>Use the menu to navigate to specific disability categories relevant to your context</p>
                  </ion-label>
                </ion-item>
                <ion-item>
                  <ion-label>
                    <h4>4. Access Resources</h4>
                    <p>Download practical tools, watch videos, and listen to audio guides</p>
                  </ion-label>
                </ion-item>
                <ion-item>
                  <ion-label>
                    <h4>5. Apply and Reflect</h4>
                    <p>Use the interactive elements to test your understanding and reflect on your practice</p>
                  </ion-label>
                </ion-item>
              </ion-list>
              
              <h3>Best Practices</h3>
              <p>Take your time exploring the content. The app is designed to be used at your own pace, allowing you to revisit sections as needed. Use the interactive features to engage actively with the material, and don't hesitate to contact the team if you have questions or suggestions for improvement.</p>
            </ion-card-content>
          </ion-card>
        </div>

        <!-- Enhanced Screening Tool/Quiz -->
        <div v-else-if="route.params.id === 'Screening'">
          <ion-card>
            <ion-card-header>
              <ion-card-title>Screening Tool</ion-card-title>
              <ion-card-subtitle>Identify areas where support may be needed</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
              <p>Answer each question. There are no right or wrong answers. Selecting an option will reveal guidance.</p>

              <div class="question-block" v-for="q in screeningQuestions" :key="q.id">
                <h4 class="question-title">{{ q.title }}</h4>
                <p class="question-prompt">{{ q.prompt }}</p>
                <ion-radio-group v-model="responses[q.id]">
                  <ion-item v-for="opt in q.options" :key="opt.value" lines="none">
                    <ion-radio :value="opt.value" slot="start"></ion-radio>
                    <ion-label>{{ opt.label }}</ion-label>
                  </ion-item>
                </ion-radio-group>

                <div class="guidance" v-if="responses[q.id]">
                  <div class="guidance-badge">Guidance</div>
                  <div v-html="optContent(q, responses[q.id])"></div>
                </div>

                <div class="divider"></div>
              </div>
            </ion-card-content>
          </ion-card>
        </div>

        <!-- Enhanced About Page -->
        <div v-else-if="route.params.id === 'Contacts'">
          <!-- Contacts -->
          <ion-card>
            <ion-card-header>
              <ion-card-title>Organizations and key contacts</ion-card-title>
            </ion-card-header>
            <ion-card-content>
              <ion-grid class="contacts-table">
                <ion-row class="contacts-header" hidden="false">
                  <ion-col size="12" size-md="4"><strong>Organization</strong></ion-col>
                  <ion-col size="12" size-md="5"><strong>Details</strong></ion-col>
                  <ion-col size="12" size-md="3"><strong>Website</strong></ion-col>
                </ion-row>

                <ion-row class="contacts-row" v-for="org in orgs" :key="org.name">
                  <ion-col size="12" size-md="4">
                    <ion-item lines="none">
                      <ion-icon :icon="org.icon" slot="start" :color="org.color"></ion-icon>
                      <ion-label>
                        <h3>{{ org.name }}</h3>
                        <ion-note color="medium">{{ org.type }}</ion-note>
                      </ion-label>
                    </ion-item>
                  </ion-col>
                  <ion-col size="12" size-md="5">
                    <p>{{ org.description }}</p>
                    <ion-note color="medium">{{ org.contact }}</ion-note>
                  </ion-col>
                  <ion-col size="12" size-md="3">
                    <ion-button fill="clear" :href="org.url" target="_blank" rel="noopener noreferrer">
                      Visit Site
                      <ion-icon :icon="openOutline" slot="end"></ion-icon>
                    </ion-button>
                  </ion-col>
                </ion-row>
              </ion-grid>
            </ion-card-content>
          </ion-card>
        </div>

        <div v-else>
          <strong class="capitalize">{{ route.params.id }}</strong>
          <p>Content for {{ route.params.id }} coming soon...</p>
        </div>
      </div>
    </ion-content>
  </ion-page>
</template>

<script setup lang="ts">
import { useRoute, useRouter } from 'vue-router';
import { ref, computed } from 'vue';
import { 
  IonButtons, 
  IonContent, 
  IonHeader, 
  IonMenuButton, 
  IonPage, 
  IonTitle, 
  IonToolbar,
  IonCard,
  IonCardHeader,
  IonCardTitle,
  IonCardSubtitle,
  IonCardContent,
  IonButton,
  IonIcon,
  IonGrid,
  IonRow,
  IonCol,
  IonList,
  IonItem,
  IonLabel,
  IonBadge,
  IonProgressBar,
  IonNote,
  IonAccordionGroup,
  IonAccordion,
  IonSegment,
  IonSegmentButton,
  IonSearchbar,
  IonThumbnail,
  IonChip,
  IonFab,
  IonFabButton,
  IonRadioGroup,
  IonRadio,
  IonSelect,
  IonSelectOption,
  IonInput,
  IonCheckbox,
  IonToggle,
  IonRange,
  IonTextarea,
  actionSheetController,
  toastController
} from '@ionic/vue';
import { ProgressService } from '../services/ProgressService';
import { 
  accessibilityOutline,
  informationCircleOutline,
  schoolOutline,
  documentOutline,
  videocamOutline,
  micOutline,
  ellipsisVertical,
  playCircle,
  play,
  checkmarkCircle,
  time,
  ellipse,
  checkmark,
  shieldCheckmark,
  people,
  school,
  informationCircle,
  refresh,
  download,
  add,
  calendar,
  mail,
  bulbOutline,
  helpCircleOutline,
  medicalOutline,
  bodyOutline,
  chatbubbleOutline,
  eyeOutline,
  earOutline,
  printOutline,
  trophy,
  arrowForward,
  openOutline
} from 'ionicons/icons';
import MediaPlayer from '../components/MediaPlayer.vue';
import { ref as vueRef } from 'vue';

const route = useRoute();
const router = useRouter();

// Quiz/Screening state
const screeningStarted = ref(false);
const screeningCompleted = ref(false);
const currentQuestion = ref(0);
const currentAnswer = ref<any>('');
const selectedVideo = ref('udl-video');
const searchTerm = ref('');
const selectedCategory = ref('all');

// Add separate state for checkbox options
const checkboxAnswers = ref<{ [key: string]: boolean }>({});

// Progress tracking
const overallProgress = ref(ProgressService.getOverallProgress());
const achievementLevel = computed(() => ProgressService.getAchievementLevel(overallProgress.value.percentage));

// Add a computed property for the current question
const currentQuizQuestionObj = computed(() => questions[currentQuestion.value]);

// Quiz questions
type QuizQuestion =
  | { type: 'radio'; question: string; options: { value: string; text: string }[] }
  | { type: 'select'; question: string; options: { value: string; text: string }[] }
  | { type: 'input'; question: string; placeholder: string }
  | { type: 'checkbox'; question: string; options: { value: string; text: string }[] }
  | { type: 'toggle'; question: string }
  | { type: 'range'; question: string; min: number; max: number; step?: number }
  | { type: 'textarea'; question: string; placeholder: string; rows?: number };

const questions: QuizQuestion[] = [
  {
    type: 'radio',
    question: "What is the primary purpose of Universal Design for Learning (UDL)?",
    options: [
      { value: 'a', text: 'To create learning experiences that work for everyone' },
      { value: 'b', text: 'To provide special accommodations for disabled students only' },
      { value: 'c', text: 'To reduce the cost of educational materials' },
      { value: 'd', text: 'To standardize all learning approaches' }
    ]
  },
  {
    type: 'select',
    question: "Select the most accessible font for students with dyslexia:",
    options: [
      { value: 'arial', text: 'Arial' },
      { value: 'times', text: 'Times New Roman' },
      { value: 'comic', text: 'Comic Sans' },
      { value: 'impact', text: 'Impact' }
    ]
  },
  {
    type: 'input',
    question: "In your own words, describe one way to make a classroom more inclusive:",
    placeholder: "Type your answer here..."
  },
  {
    type: 'checkbox',
    question: "Which of the following are assistive technologies? (Select all that apply)",
    options: [
      { value: 'screenreader', text: 'Screen Reader' },
      { value: 'hearingaid', text: 'Hearing Aid' },
      { value: 'calculator', text: 'Calculator' },
      { value: 'wheelchair', text: 'Wheelchair' }
    ]
  },
  {
    type: 'toggle',
    question: "Do you use assistive technology in your classroom?"
  },
  {
    type: 'range',
    question: "How confident are you in supporting students with disabilities? (0 = Not confident, 10 = Very confident)",
    min: 0,
    max: 10,
    step: 1
  },
  {
    type: 'textarea',
    question: "Describe a specific challenge you've faced in supporting students with disabilities and how you addressed it:",
    placeholder: "Share your experience here...",
    rows: 6
  }
];

// Quiz results
const results = ref([
  {
    name: 'Physical Disabilities',
    description: 'Understanding of visual, hearing, and mobility impairments',
    score: 85,
    level: 'Advanced',
    color: 'primary',
    icon: 'body-outline'
  },
  {
    name: 'Cognition & Learning',
    description: 'Knowledge of dyslexia, ADHD, and learning differences',
    score: 72,
    level: 'Intermediate',
    color: 'secondary',
    icon: 'bulb-outline'
  },
  {
    name: 'Communication & Interaction',
    description: 'Awareness of autism spectrum and social communication needs',
    score: 68,
    level: 'Intermediate',
    color: 'tertiary',
    icon: 'chatbubble-outline'
  },
  {
    name: 'Multiple Impairments',
    description: 'Understanding of complex and combined disabilities',
    score: 45,
    level: 'Beginner',
    color: 'warning',
    icon: 'medical-outline'
  }
]);

// Resources data
const resources = ref([
  {
    id: 1,
    title: 'Accessibility Guidelines',
    description: 'Comprehensive guide for creating accessible content',
    category: 'documents',
    icon: documentOutline,
    color: 'primary'
  },
  {
    id: 2,
    title: 'Case Study Videos',
    description: 'Real-world examples of inclusive teaching practices',
    category: 'videos',
    icon: videocamOutline,
    color: 'secondary'
  },
  {
    id: 3,
    title: 'Audio Resources',
    description: 'Podcasts and audio guides for educators',
    category: 'audio',
    icon: micOutline,
    color: 'tertiary'
  },
  {
    id: 4,
    title: 'UDL Implementation Guide',
    description: 'Step-by-step guide to implementing UDL principles',
    category: 'documents',
    icon: documentOutline,
    color: 'success'
  },
  {
    id: 5,
    title: 'Assistive Technology Overview',
    description: 'Video overview of available assistive technologies',
    category: 'videos',
    icon: videocamOutline,
    color: 'warning'
  }
]);

const filteredResources = computed(() => {
  let filtered = resources.value;
  
  if (selectedCategory.value !== 'all') {
    filtered = filtered.filter(r => r.category === selectedCategory.value);
  }
  
  if (searchTerm.value) {
    filtered = filtered.filter(r => 
      r.title.toLowerCase().includes(searchTerm.value.toLowerCase()) ||
      r.description.toLowerCase().includes(searchTerm.value.toLowerCase())
    );
  }
  
  return filtered;
});

const getPageTitle = () => {
  const rawId = route.params.id;
  if (rawId === undefined || rawId === null) {
    return 'SAGE Disability v0.0.7';
  }
  const id = String(rawId);
  console.log('Route ID:', id); // Debug logging
  
  // Handle case sensitivity - check both exact match and case-insensitive
  const titles: { [key: string]: string } = {
    'Home': 'SAGE Disability v0.0.7',
    'home': 'SAGE Disability v0.0.7', // Add lowercase version
    'Introduction': 'Introduction',
    'Screening': 'Screening Tool',
    'Contacts': 'Contacts'
  };
  
  // Try exact match first, then case-insensitive
  let title = titles[id];
  if (!title) {
    // Try to find a case-insensitive match
    const lowerId = id.toLowerCase();
    for (const [key, value] of Object.entries(titles)) {
      if (key.toLowerCase() === lowerId) {
        title = value;
        break;
      }
    }
  }
  
  const finalTitle = title || id || 'SAGE Disability v0.0.7';
  console.log('Page title:', finalTitle); // Debug logging
  return finalTitle;
};

const startScreening = () => {
  screeningStarted.value = true;
  currentQuestion.value = 0;
  // Set initial answer type
  const q = questions[0];
  if (q.type === 'checkbox') {
    currentAnswer.value = [];
    // Initialize checkbox answers
    checkboxAnswers.value = {};
    if (q.type === 'checkbox') {
      q.options.forEach(option => {
        checkboxAnswers.value[option.value] = false;
      });
    }
  } else if (q.type === 'toggle') {
    currentAnswer.value = false;
  } else if (q.type === 'range') {
    currentAnswer.value = q.min;
  } else {
    currentAnswer.value = '';
  }
  screeningCompleted.value = false;
};

const nextQuestion = () => {
  if (currentQuestion.value < questions.length - 1) {
    currentQuestion.value++;
    // Set initial answer type for next question
    const nextQ = questions[currentQuestion.value];
    if (nextQ.type === 'checkbox') {
      currentAnswer.value = [];
      // Initialize checkbox answers for next question
      checkboxAnswers.value = {};
      if (nextQ.type === 'checkbox') {
        nextQ.options.forEach(option => {
          checkboxAnswers.value[option.value] = false;
        });
      }
    } else if (nextQ.type === 'toggle') {
      currentAnswer.value = false;
    } else if (nextQ.type === 'range') {
      currentAnswer.value = nextQ.min;
    } else {
      currentAnswer.value = '';
    }
  } else {
    screeningCompleted.value = true;
  }
};

const resetScreening = () => {
  screeningStarted.value = false;
  screeningCompleted.value = false;
  currentQuestion.value = 0;
  currentAnswer.value = '';
};

const playVideo = (type: string) => {
  console.log(`Playing video: ${type}`);
  // Video player implementation would go here
};

const playAudio = (type: string) => {
  console.log(`Playing audio: ${type}`);
  // Audio player implementation would go here
};

const navigateTo = (page: string) => {
  router.push(`/folder/${page}`);
};

const showToast = (message: string) => {
  if (typeof toastController !== 'undefined') {
    toastController.create({
      message,
      duration: 2000,
      position: 'bottom',
      color: 'success'
    }).then(toast => toast.present());
  }
};

const openAccessibilitySettings = () => {
  // Open accessibility settings modal or navigate to settings page
  console.log('Opening accessibility settings');
  showToast('Accessibility settings coming soon!');
};

const showFallbackOptions = () => {
  console.log('Showing fallback options');
  
  // Check if we're in a browser environment
  if (typeof window === 'undefined') {
    console.warn('Not in browser environment, cannot show fallback');
    return;
  }
  
  try {
    // Simple alert as fallback
    const options = [
      'Print Page',
      'Accessibility'
    ];
    
    const choice = prompt(`Choose an option:\n${options.map((opt, i) => `${i + 1}. ${opt}`).join('\n')}`);
    
    console.log('User selected option:', choice);
    
    switch(choice) {
      case '1': 
        console.log('Executing print function');
        printPage(); 
        break;
      case '2': 
        console.log('Executing accessibility function');
        openAccessibilitySettings(); 
        break;
      default:
        console.log('No option selected or invalid choice');
    }
  } catch (error) {
    console.error('Error in fallback options:', error);
    // Last resort: just trigger print
    printPage();
  }
};

const presentActionSheet = async () => {
  console.log('Action sheet triggered');
  
  // Check if actionSheetController is available
  if (typeof actionSheetController === 'undefined') {
    console.warn('actionSheetController not available, using fallback');
    showFallbackOptions();
    return;
  }
  
  try {
    console.log('Creating action sheet...');
    const actionSheet = await actionSheetController.create({
      header: 'Page Options',
      buttons: [
        {
          text: 'Print Page',
          icon: 'print-outline',
          handler: () => {
            console.log('Print option selected');
            printPage();
          }
        },
        {
          text: 'Accessibility',
          icon: 'accessibility-outline',
          handler: () => {
            console.log('Accessibility option selected');
            openAccessibilitySettings();
          }
        },
        {
          text: 'Cancel',
          icon: 'close',
          role: 'cancel'
        }
      ]
    });
    
    console.log('Presenting action sheet...');
    await actionSheet.present();
    console.log('Action sheet presented successfully');
    
  } catch (error) {
    console.error('Error presenting action sheet:', error);
    console.log('Using fallback options');
    // Fallback: show a simple alert with options
    showFallbackOptions();
  }
};

const printPage = () => {
  console.log('Print function called');
  
  // Check if we're in a browser environment
  if (typeof window === 'undefined' || typeof document === 'undefined') {
    console.warn('Print function called in non-browser environment');
    return;
  }
  
  try {
    // Get the current page content
    const container = document.querySelector('#container');
    if (!container) {
      console.error('Container not found');
      window.print(); // Fallback
      return;
    }
    
    console.log('Container found:', container);
    console.log('Container content:', container.innerHTML);
    
    // Create a new window with the content
    const printWindow = window.open('', '_blank');
    if (!printWindow) {
      console.error('Could not open print window');
      window.print(); // Fallback
      return;
    }
    
    // Write the content to the new window
    printWindow.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>SAGE - ${document.title}</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .print-header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 10px; }
            .print-content { margin: 20px 0; }
            .print-footer { text-align: center; margin-top: 30px; border-top: 1px solid #ccc; padding-top: 10px; font-size: 12px; color: #666; }
            @media print {
              body { margin: 0; }
            }
          </style>
        </head>
        <body>
          <div class="print-header">
            <h1>SAGE - Supporting Accessible and Inclusive Education</h1>
            <p>Printed on: ${new Date().toLocaleDateString()}</p>
          </div>
          <div class="print-content">
            ${container.innerHTML}
          </div>
          <div class="print-footer">
            SAGE - Supporting Accessible and Inclusive Education
          </div>
        </body>
      </html>
    `);
    
    printWindow.document.close();
    
    // Wait for content to load then print
    printWindow.onload = () => {
      console.log('Print window loaded, triggering print...');
      printWindow.print();
      printWindow.close();
    };
    
  } catch (error) {
    console.error('Error during print:', error);
    // Fallback to simple print
    window.print();
  }
};

const filterResources = () => {
  // Filtering is handled by computed property
};

const openResource = (resource: any) => {
  console.log(`Opening resource: ${resource.title}`);
  // Resource viewer implementation would go here
};

const downloadResource = (resource: any) => {
  console.log(`Downloading resource: ${resource.title}`);
  // Download implementation would go here
};

const contactTeam = async () => {
  // if (typeof toastController === 'undefined') return;
  // const toast = await toastController.create({
  //   message: 'Contact form would open here',
  //   duration: 2000,
  //   position: 'bottom'
  // });
  // await toast.present();
};

const orgs = ref([
  {
    name: 'Ministry of Primary and Secondary Education (MoPSE)',
    type: 'Government Ministry',
    description: 'Leads Zimbabwe\'s primary and secondary education policy, curriculum and services.',
    contact: 'Government Portal',
    url: 'https://www.zim.gov.zw/index.php/en/my-government/government-ministries/primary-and-secondary-education',
    icon: school,
    color: 'primary'
  },
  {
    name: 'Ministry of Health and Child Care (MoHCC)',
    type: 'Government Ministry',
    description: 'Health services including rehabilitation, audiology, vision and assistive devices.',
    contact: 'Official site',
    url: 'http://www.mohcc.gov.zw/',
    icon: medicalOutline,
    color: 'danger'
  },
  {
    name: 'UNICEF Zimbabwe',
    type: 'UN Agency',
    description: 'Supports inclusive education, child protection and Learning Passport with MoPSE.',
    contact: 'unicef.org/zimbabwe',
    url: 'https://www.unicef.org/zimbabwe/',
    icon: people,
    color: 'tertiary'
  },
  {
    name: 'Plan International Zimbabwe (SAGE Lead)',
    type: 'International NGO',
    description: 'Leads SAGE consortium; programmes on girls\' education and protection.',
    contact: 'plan-international.org/zimbabwe',
    url: 'https://plan-international.org/zimbabwe/',
    icon: people,
    color: 'secondary'
  },
  {
    name: 'Deaf Zimbabwe Trust (DZT)',
    type: 'Disabled Persons Organisation (Deaf)',
    description: 'Advocacy and support for deaf children and youth; promotes Zim Sign Language.',
    contact: 'deafzimbabwetrust.org',
    url: 'https://deafzimbabwetrust.org/',
    icon: earOutline,
    color: 'primary'
  },
  {
    name: 'Jairos Jiri Association',
    type: 'Rehabilitation & Support',
    description: 'Rehabilitation, education and vocational training for persons with disabilities.',
    contact: 'Official site',
    url: '#',
    icon: medicalOutline,
    color: 'secondary'
  },
  {
    name: 'Federation of Organizations of Disabled People in Zimbabwe (FODPZ)',
    type: 'Federation of DPOs',
    description: 'Umbrella body coordinating DPOs and national advocacy on disability rights.',
    contact: 'Official site',
    url: '#',
    icon: people,
    color: 'warning'
  },
  {
    name: 'MoPSE Learning Passport',
    type: 'e-Learning Platform',
    description: 'Digital learning platform by MoPSE in partnership with UNICEF and Microsoft.',
    contact: 'learningpassport.unicef.org',
    url: 'https://mopsezw.learningpassport.unicef.org/',
    icon: school,
    color: 'success'
  }
]);

const screeningQuestions = vueRef([
  {
    id: 'vision',
    title: 'VISION',
    prompt: 'Does your learner have difficulty seeing, even if wearing glasses? Would you say…',
    options: [
      { value: 'none', label: 'No difficulty' },
      { value: 'some', label: 'Some difficulty' },
      { value: 'lot', label: 'A lot of difficulty' },
      { value: 'cannot', label: 'Cannot do at all' }
    ]
  },
  {
    id: 'hearing',
    title: 'HEARING',
    prompt: 'Does your learner have difficulty hearing, even if using a hearing aid(s)? Would you say…',
    options: [
      { value: 'none', label: 'No difficulty' },
      { value: 'some', label: 'Some difficulty' },
      { value: 'lot', label: 'A lot of difficulty' },
      { value: 'cannot', label: 'Cannot do at all' }
    ]
  },
  {
    id: 'mobility',
    title: 'MOBILITY',
    prompt: 'Does your learner have difficulty walking or climbing steps? Would you say…',
    options: [
      { value: 'none', label: 'No difficulty' },
      { value: 'some', label: 'Some difficulty' },
      { value: 'lot', label: 'A lot of difficulty' },
      { value: 'cannot', label: 'Cannot do at all' }
    ]
  },
  {
    id: 'cognition',
    title: 'COGNITION (REMEMBERING)',
    prompt: 'Does your learner have difficulty remembering or concentrating? Would you say…',
    options: [
      { value: 'none', label: 'No difficulty' },
      { value: 'some', label: 'Some difficulty' },
      { value: 'lot', label: 'A lot of difficulty' },
      { value: 'cannot', label: 'Cannot do at all' }
    ]
  },
  {
    id: 'selfcare',
    title: 'SELF-CARE',
    prompt: 'Does your learner have difficulty with self-care, such as washing all over or dressing? Would you say…',
    options: [
      { value: 'none', label: 'No difficulty' },
      { value: 'some', label: 'Some difficulty' },
      { value: 'lot', label: 'A lot of difficulty' },
      { value: 'cannot', label: 'Cannot do at all' }
    ]
  },
  {
    id: 'communication',
    title: 'COMMUNICATION',
    prompt: 'Using their usual language, does your learner have difficulty communicating, for example understanding or being understood? Would you say…',
    options: [
      { value: 'none', label: 'No difficulty' },
      { value: 'some', label: 'Some difficulty' },
      { value: 'lot', label: 'A lot of difficulty' },
      { value: 'cannot', label: 'Cannot do at all' }
    ]
  }
]);

const responses = vueRef<Record<string, string>>({});

const directoryInfo = {
  vision: {
    support: [
      {
        name: 'Dorothy Duncan Centre',
        address: '119 Fife Avenue 3rd/4th Street, Harare, Box 4489 Harare',
        services: 'Provision of reading and educational materials for the blind and partially sighted',
        phone: '+263 242 251117 / 496667'
      }
    ],
    urgent: [
      {
        name: 'Council for the Blind',
        address: 'Fife St / 15th Avenue, Bulawayo',
        services: 'Eye Health services and spectacles.',
        phone: '+263 712 209 822'
      }
    ]
  }
};

const optContent = (q: any, value: string) => {
  if (q.id === 'vision') {
    if (value === 'none') {
      return '<p>Answer: Your learner does not need additional support for their vision.</p>';
    }
    if (value === 'some') {
      return `<p>Answer: Find out how you can support your learner in the Visual Needs section <a href=\"/disability/xxxxxxx\">here</a>.</p>`;
    }
    if (value === 'lot') {
      const orgsHtml = directoryInfo.vision.support.map(o => `<div class=\"org-card\"><strong>${o.name}</strong><br/><small>${o.address}</small><br/>${o.services}<br/><em>${o.phone}</em></div>`).join('');
      return `<p>Answer: Find out how you can support your learner in the Visual Needs section <a href=\"/disability/xxxxxxx\">here</a> and contact an organisation for more support and resources.</p>${orgsHtml}`;
    }
    if (value === 'cannot') {
      const orgsHtml = directoryInfo.vision.urgent.map(o => `<div class=\"org-card\"><strong>${o.name}</strong><br/><small>${o.address}</small><br/>${o.services}<br/><em>${o.phone}</em></div>`).join('');
      return `<p>Answer: Find out how you can support your learner in the Visual Needs section <a href=\"/disability/xxxxxxx\">here</a> and contact an organisation for an urgent referral and diagnosis.</p>${orgsHtml}`;
    }
  }
  if (q.id === 'hearing') {
    if (value === 'none') return '<p>Your learner does not need additional support for their hearing.</p>';
    if (value === 'some' || value === 'lot' || value === 'cannot') {
      return `<p>Find out how you can support your learner in the Hearing Needs section <a href=\"/needs/hearing\">here</a>.</p>`;
    }
  }
  // For other categories, simple generic message
  if (value === 'none') return '<p>No additional support indicated at this time.</p>';
  return '<p>Consider support strategies in the relevant section of this toolkit and consult local services if needed.</p>';
};
</script>

<style scoped>
ion-card {
  margin: 16px;
}

ion-progress-bar {
  margin: 8px 0;
}

ion-segment {
  margin: 16px;
}

ion-searchbar {
  margin: 16px;
}

ion-fab {
  margin-bottom: 16px;
}

ion-accordion ion-item[slot="header"] {
  --background: var(--ion-color-light);
}

ion-accordion .ion-padding {
  padding: 16px;
}

ion-chip {
  margin: 4px;
}

ion-thumbnail {
  --size: 48px;
}

ion-radio-group ion-item {
  --padding-start: 0;
}

ion-badge {
  margin-top: 8px;
}

.sage-cover-illustration-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 16px;
  padding: 16px;
  background-color: var(--ion-color-light);
  border-radius: 8px;
  overflow: hidden;
}

.sage-cover-illustration {
  max-width: 100%;
  height: auto;
  display: block;
  border-radius: 8px;
}

@media (max-width: 768px) {
  .sage-cover-illustration-wrapper {
    padding: 8px;
  }
}

/* Print Styles */
@media print {
/* Hide navigation elements */
  ion-header, 
  ion-toolbar, 
  ion-buttons, 
  ion-menu-button,
  ion-fab,
  ion-fab-button {
    display: none !important;
  }
  
/* Reset content padding and margins */
  ion-content {
    padding: 0 !important;
    margin: 0 !important;
    --padding-top: 0 !important;
    --padding-bottom: 0 !important;
    height: auto !important;
    overflow: visible !important;
    position: static !important;
  }
  
/* Ensure the page shows all content */
  ion-page {
    height: auto !important;
    overflow: visible !important;
    position: static !important;
    display: block !important;
  }
}

/* Progress Summary Card Styles */
.progress-summary-card {
  background: linear-gradient(135deg, var(--ion-color-primary-tint), var(--ion-color-secondary-tint));
  color: white;
}

.progress-summary-card ion-card-title,
.progress-summary-card ion-card-subtitle {
  color: white;
}

.progress-summary-content {
  display: flex;
  align-items: center;
  gap: 20px;
}

.progress-circle-small {
  width: 80px;
  height: 80px;
  border-radius: 50%;
  background: conic-gradient(
    var(--ion-color-success) calc(var(--progress) * 3.6deg),
    rgba(255, 255, 255, 0.3) calc(var(--progress) * 3.6deg)
  );
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  flex-shrink: 0;
}

.progress-circle-inner-small {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.9);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--ion-color-primary);
}

.progress-percentage-small {
  font-size: 1.2rem;
  font-weight: bold;
  line-height: 1;
}

.progress-details {
  flex: 1;
}

.achievement-chip-small {
  margin-bottom: 8px;
}

.progress-stats-small {
  margin: 8px 0;
  font-size: 0.9rem;
  opacity: 0.9;
}

.view-progress-btn {
  margin-top: 8px;
  --color: var(--ion-color-primary);
}

/* Print Styles */
@media print {
  ion-header, 
  ion-toolbar, 
  ion-buttons, 
  ion-menu-button,
  ion-fab,
  ion-fab-button {
    display: none !important;
  }
  
  /* Reset content padding and margins */
  ion-content {
    padding: 0 !important;
    margin: 0 !important;
    --padding-top: 0 !important;
    --padding-bottom: 0 !important;
    height: auto !important;
    overflow: visible !important;
    position: static !important;
  }
  
  /* Ensure the page shows all content */
  ion-page {
    height: auto !important;
    overflow: visible !important;
    position: static !important;
    display: block !important;
  }

  /* Override Ionic's viewport restrictions */
  .ion-page {
    height: auto !important;
    overflow: visible !important;
    position: static !important;
    display: block !important;
  }

  /* Ensure scroll containers don't limit content */
  .ion-content-scroll-host {
    height: auto !important;
    overflow: visible !important;
    position: static !important;
  }
    
  /* Format container for print */
  #container {
    padding: 20px !important;
    max-width: 800px !important;
    margin: 0 auto !important;
    height: auto !important;
    overflow: visible !important;
  }

  /* Show all divs that might be hidden */
  div {
    display: block !important;
    height: auto !important;
    overflow: visible !important;
  }

  /* Ensure specific content elements are visible */
  ion-card,
  ion-card-content,
  ion-accordion-group,
  ion-accordion,
  ion-list,
  ion-item {
    display: block !important;
    height: auto !important;
    overflow: visible !important;
  }

  /* Ensure accordions are expanded for print */
  ion-accordion {
    --ion-item-background: transparent !important;
  }

  ion-accordion ion-item[slot="header"] {
    background: #f8f9fa !important;
  }

  ion-accordion .ion-padding {
    display: block !important;
    height: auto !important;
    overflow: visible !important;
  }

  /* Format cards for print */
  ion-card {
    margin: 16px 0 !important;
    box-shadow: none !important;
    border: 1px solid #ddd !important;
    page-break-inside: avoid !important;
  }

  ion-card-header {
    padding: 16px !important;
    background: #f8f9fa !important;
  }

  ion-card-content {
    padding: 16px !important;
  }

  /* Format accordions for print */
  ion-accordion-group {
    border: none !important;
  }

  ion-accordion {
    border: 1px solid #ddd !important;
    margin: 8px 0 !important;
  }

  ion-accordion ion-item[slot="header"] {
    background: #f8f9fa !important;
    border-bottom: 1px solid #ddd !important;
  }

  /* Format lists and items for print */
  ion-list {
    padding: 0 !important;
  }

  ion-item {
    --padding-start: 0 !important;
    --padding-end: 0 !important;
    border-bottom: 1px solid #eee !important;
  }

  ion-label {
    color: #000 !important;
  }

  /* Format progress bars and other elements */
  ion-progress-bar {
    border: 1px solid #ddd !important;
  }

  ion-note {
    color: #666 !important;
  }

  ion-chip {
    border: 1px solid #ddd !important;
    background: #f8f9fa !important;
  }

  /* Format grid for print */
  ion-grid {
    padding: 0 !important;
  }

  ion-col {
    padding: 8px !important;
  }

  /* Format search and segment controls */
  ion-searchbar,
  ion-segment {
    display: none !important;
  }

  /* Format images for print */
  .sage-cover-illustration {
    max-width: 100% !important;
    height: auto !important;
  }

  /* Ensure all page sections are visible */
  div[v-if] {
    display: block !important;
  }

  /* Show the currently active page content */
  div[v-if="route.params.id === 'Home'"],
  div[v-if="route.params.id === 'Contacts'"],
  div[v-if="route.params.id === 'Contact'"],
  div[v-if="route.params.id === 'Quiz'"] {
    display: block !important;
    height: auto !important;
    overflow: visible !important;
  }

  /* Ensure all cards and content are visible */
  ion-card,
  ion-card-content,
  ion-accordion-group,
  ion-accordion {
    display: block !important;
    height: auto !important;
    overflow: visible !important;
  }

  /* Ensure content scroll host is visible */
  .ion-content-scroll-host {
    height: auto !important;
    overflow: visible !important;
    position: static !important;
  }

  /* Add footer for print */
  body::after {
    content: "Printed from SAGE - Supporting Accessible and Inclusive Education | Date: " attr(data-print-date);
    display: block;
    text-align: center;
    margin-top: 40px;
    padding-top: 20px;
    border-top: 1px solid #ddd;
    font-size: 12px;
    color: #666;
  }
}
</style>

<style>
/* Global print styles - not scoped */
@media print {
/* Debug: Add a visible border to see if content is there */
#container {
    border: 2px solid red !important;
  }
  
/* Debug: Make sure content is visible */
  ion-content {
    background: white !important;
  }
/* Hide only navigation elements, not content */
  ion-header, 
  ion-toolbar, 
  ion-buttons, 
  ion-menu-button,
  ion-fab,
  ion-fab-button {
    display: none !important;
  }
  
/* Ensure content is visible */
  ion-content {
    padding: 0 !important;
    margin: 0 !important;
    height: auto !important;
    overflow: visible !important;
    position: static !important;
    display: block !important;
  }
  
/* Ensure page container is visible */
  ion-page {
    height: auto !important;
    overflow: visible !important;
    position: static !important;
    display: block !important;
  }
  
/* Ensure the main container is visible */
#container {
    display: block !important;
    height: auto !important;
    overflow: visible !important;
    padding: 20px !important;
  }
  
/* Ensure all divs with content are visible */
div {
    display: block !important;
    height: auto !important;
    overflow: visible !important;
  }
  
/* Ensure cards are visible */
ion-card {
    display: block !important;
    height: auto !important;
    overflow: visible !important;
  }
}
</style>

<style scoped>
.sponsors-img {
  width: 100%;
  height: auto;
  display: block;
  border-radius: 8px;
  margin: 8px 0 12px 0;
}

.partners-strip {
  display: grid;
  grid-template-columns: repeat(4, minmax(0, 1fr));
  gap: 12px;
  align-items: center;
  margin-bottom: 12px;
}

.partners-strip img {
  width: 100%;
  height: auto;
  object-fit: contain;
  background: transparent;
}

@media (max-width: 720px) {
  .partners-strip {
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 10px;
  }
}

@media (max-width: 420px) {
  .partners-strip {
    grid-template-columns: 1fr 1fr;
    gap: 8px;
  }
}

.contacts-table {
  width: 100%;
  border-collapse: collapse;
}

.contacts-header {
  background-color: #f8f9fa;
  font-weight: bold;
}

.contacts-row {
  border-bottom: 1px solid #ddd;
}

.contacts-header,
.contacts-row {
  padding: 8px;
  text-align: left;
}

.contacts-header {
  display: none;
}

@media (min-width: 768px) {
  .contacts-header {
    display: table-row;
  }
}
.question-block { margin: 16px 0; }
.question-title { margin: 0 0 6px 0; font-size: 16px; font-weight: 600; }
.question-prompt { margin: 0 0 8px 0; color: var(--ion-color-medium); }
.question-block ion-item { --background: transparent; border-radius: 8px; }
.question-block ion-item:hover { --background: rgba(var(--ion-color-primary-rgb), 0.06); }

.guidance {
  margin: 10px 0 0 0;
  padding: 12px;
  background: rgba(var(--ion-color-primary-rgb), 0.06);
  border-left: 4px solid var(--ion-color-primary);
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.06);
}

.guidance-badge {
  display: inline-block;
  font-size: 11px;
  letter-spacing: .02em;
  text-transform: uppercase;
  color: var(--ion-color-primary);
  background: rgba(var(--ion-color-primary-rgb), 0.12);
  padding: 2px 8px;
  border-radius: 999px;
  margin-bottom: 8px;
}
.divider { height: 1px; background: var(--ion-color-light); opacity: 0.6; margin-top: 12px; }
.org-card {
  padding: 10px;
  margin-top: 8px;
  background: #fff;
  border: 1px solid var(--ion-color-light);
  border-left: 3px solid var(--ion-color-medium);
  border-radius: 6px;
  box-shadow: 0 1px 4px rgba(0,0,0,0.04);
}
</style>
